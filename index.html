<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Äiá»ƒm danh há»c sinh</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header>
    <h1>ğŸ“‹ Äiá»ƒm danh há»c sinh</h1>
    <a href="register.html">ÄÄƒng kÃ½ há»c sinh</a>
    <a href="teacher-login.html">ÄÄƒng nháº­p giÃ¡o viÃªn</a>
  </header>

  <div class="card">
    <h2>Chá»n trÆ°á»ng & lá»›p</h2>
    <label>TrÆ°á»ng</label>
    <select id="schoolSelect">
      <option value="">-- Chá»n trÆ°á»ng --</option>
    </select>
    <label>Lá»›p</label>
    <select id="classSelect">
      <option value="">-- Chá»n lá»›p --</option>
    </select>
    <label>QuÃ©t QR (hoáº·c nháº­p/dÃ¡n classId_slotId)</label>
    <div class="row">
      <input type="text" id="qrInput" placeholder="VÃ­ dá»¥: abc123_slot456" class="col">
      <button id="scanBtn">XÃ¡c nháº­n</button>
      <button id="scanQrBtn" class="secondary">QuÃ©t QR báº±ng camera</button>
    </div>
  </div>

  <div class="card">
    <h2>Nháº­p MSSV & má»Ÿ camera</h2>
    <label>MÃ£ sá»‘ sinh viÃªn</label>
    <input type="text" id="mssvInput" placeholder="Nháº­p MSSV">
    <button id="startCameraBtn">Má»Ÿ camera</button>
  </div>

  <div id="cameraSection" class="card hidden">
    <h2>Camera</h2>
    <div class="video-container">
      <video id="videoEl" width="480" height="360" autoplay playsinline></video>
    </div>
    <canvas id="faceCanvas"></canvas>
    <button id="submitAttendanceBtn">Äiá»ƒm danh</button>
  </div>

  <div id="attendanceResult"></div>

  <!-- Modal quÃ©t QR -->
  <div id="qrScanModal" class="modal hidden">
    <div class="modal-content card">
      <h2>QuÃ©t mÃ£ QR</h2>
      <div id="qrReader" style="width:100%;max-width:300px;"></div>
      <button id="closeQrScanBtn" class="secondary">ÄÃ³ng</button>
    </div>
  </div>

  <script type="module">
    try {
      const { initStudentPage } = await import("./js/student.js");
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", () => initStudentPage());
      } else {
        initStudentPage();
      }
    } catch (e) {
      console.error(e);
      alert("Lá»—i load trang há»c sinh: " + (e.message || e));
    }
  </script>
  <style>
    .hidden { display: none !important; }
    .modal { position:fixed; inset:0; background:rgba(0,0,0,0.5); display:flex; align-items:center; justify-content:center; z-index:9998; }
    .modal-content { max-width: 90%; }
  </style>
  <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
</body>
</html>
